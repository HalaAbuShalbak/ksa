<!DOCTYPE html>
<html lang="ar" dir="rtl" class="overflow-x-hidden">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="سجل الدخول إلى حسابك"
    />
    <title>تسجيل الدخول - خدماتنا</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&family=Tajawal:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#FF8059",
              secondary: "#5FD2BB",
              accent: "#FFCA3A",
              background: "#F7F9FA",
              contrast: "#22242A",
              card: "#FFFFFF",
              border: "#E0E3EB",
              muted: "#B0B2B8",
            },
            fontFamily: {
              cairo: ["Cairo", "sans-serif"],
              tajawal: ["Tajawal", "sans-serif"],
            },
          },
        },
      };
    </script>

    <!-- Custom Styles -->
    <style type="text/tailwindcss">
      * {
        box-sizing: border-box;
      }
      
      html {
        overflow-x: hidden !important;
        width: 100%;
        position: relative;
      }
      
      body {
        overflow-x: hidden !important;
        width: 100%;
        position: relative;
        margin: 0;
        padding: 0;
      }

      @layer components {
        .btn {
          @apply font-tajawal py-2.5 px-6 rounded-full text-base transition-all duration-300 ease-in-out shadow-md;
        }

        .btn-primary {
          @apply bg-primary text-white hover:bg-opacity-90;
        }

        .btn-secondary {
          @apply bg-transparent text-primary border border-primary hover:bg-primary hover:text-white;
        }

        .form-input {
          @apply w-full p-3 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bg-background text-contrast font-tajawal;
        }

        .form-label {
          @apply block text-sm font-medium text-contrast mb-2 font-tajawal;
        }
      }

      @keyframes fade-in-up {
        0% {
          opacity: 0;
          transform: translateY(20px);
        }
        100% {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .fade-in-up {
        animation: fade-in-up 0.8s ease-out forwards;
      }

      @keyframes blob-float {
        0%,
        100% {
          transform: translateY(0) scale(1);
        }
        33% {
          transform: translateY(-20px) scale(1.1);
        }
        66% {
          transform: translateY(20px) scale(0.9);
        }
      }

      .animate-blob-float {
        animation: blob-float 8s ease-in-out infinite;
      }

      .password-toggle {
        @apply absolute left-3 top-1/2 -translate-y-1/2 text-muted cursor-pointer hover:text-primary transition-colors;
      }
    </style>
  </head>
  <body class="font-tajawal text-contrast bg-background antialiased overflow-x-hidden min-h-screen">
    <!-- Animated Blobs Background -->
    <div class="absolute inset-0 z-0 opacity-20">
      <div
        class="blob-1 w-64 h-64 bg-primary rounded-full absolute top-1/4 left-1/4 animate-blob-float mix-blend-multiply filter blur-2xl"
      ></div>
      <div
        class="blob-2 w-96 h-96 bg-secondary rounded-full absolute bottom-1/3 right-1/4 animate-blob-float delay-1000 mix-blend-multiply filter blur-3xl"
      ></div>
      <div
        class="blob-3 w-80 h-80 bg-accent rounded-full absolute top-1/2 left-1/3 animate-blob-float delay-500 mix-blend-multiply filter blur-3xl"
      ></div>
    </div>

    <!-- Header -->
    <header
      class="sticky top-0 z-50 bg-background/80 backdrop-blur-md shadow-sm"
    >
      <nav
        class="container mx-auto px-4 py-3 flex items-center justify-between"
      >
        <div class="flex items-center">
          <a href="index.html" class="text-xl sm:text-2xl font-cairo font-bold text-primary"
            >شعارك</a
          >
        </div>

        <div class="flex items-center space-x-3 space-x-reverse">
          <a href="index.html" class="text-contrast hover:text-primary transition-colors font-tajawal">
            <i class="fas fa-arrow-right ml-2"></i>
            العودة للرئيسية
          </a>
        </div>
      </nav>
    </header>

    <!-- Main Content -->
    <main class="relative z-10 flex items-center justify-center min-h-[calc(100vh-80px)] py-12 px-4">
      <div class="w-full max-w-md fade-in-up">
        <!-- Sign In Card -->
        <div class="bg-card rounded-2xl shadow-2xl p-8 md:p-10">
          <!-- Header -->
          <div class="text-center mb-8">
            <div class="w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4">
              <i class="fas fa-sign-in-alt text-primary text-3xl"></i>
            </div>
            <h1 class="text-3xl font-cairo font-bold text-contrast mb-2">
              تسجيل الدخول
            </h1>
            <p class="text-muted font-tajawal">
              أدخل بياناتك للدخول إلى حسابك
            </p>
          </div>

          <!-- Form -->
          <form id="signin-form" class="space-y-5">
            <!-- Mobile Number or Email -->
            <div>
              <label for="identifier" class="form-label">
                <i class="fas fa-user text-primary ml-2"></i>
                رقم الجوال أو البريد الإلكتروني
              </label>
              <input
                type="text"
                id="identifier"
                name="identifier"
                class="form-input"
                placeholder="أدخل رقم الجوال أو البريد الإلكتروني"
                required
              />
              <span class="error-message text-red-500 text-sm hidden"></span>
            </div>

            <!-- Password -->
            <div class="relative">
              <label for="password" class="form-label">
                <i class="fas fa-lock text-primary ml-2"></i>
                كلمة المرور
              </label>
              <input
                type="password"
                id="password"
                name="password"
                class="form-input pr-10"
                placeholder="أدخل كلمة المرور"
                required
              />
              <button
                type="button"
                id="toggle-password"
                class="password-toggle"
                aria-label="إظهار/إخفاء كلمة المرور"
              >
                <i class="fas fa-eye" id="password-icon"></i>
              </button>
              <span class="error-message text-red-500 text-sm hidden"></span>
            </div>

            <!-- Remember Me & Forgot Password -->
            <div class="flex items-center justify-between">
              <label class="flex items-center cursor-pointer">
                <input
                  type="checkbox"
                  id="rememberMe"
                  name="rememberMe"
                  class="w-4 h-4 text-primary border-border rounded focus:ring-primary focus:ring-2"
                />
                <span class="text-sm text-contrast mr-2 font-tajawal">تذكرني</span>
              </label>
              <a
                href="#"
                id="forgot-password-link"
                class="text-sm text-primary hover:underline font-tajawal"
              >
                نسيت كلمة المرور؟
              </a>
            </div>

            <!-- Submit Button -->
            <button
              type="submit"
              id="signin-button"
              class="btn btn-primary w-full mt-6"
            >
              <i class="fas fa-sign-in-alt ml-2"></i>
              تسجيل الدخول
            </button>

            <!-- Loading Spinner (hidden by default) -->
            <div id="loading-spinner" class="hidden text-center">
              <i class="fas fa-spinner fa-spin text-primary text-2xl"></i>
              <p class="text-muted mt-2">جاري تسجيل الدخول...</p>
            </div>

            <!-- Success Message (hidden by default) -->
            <div id="success-message" class="hidden bg-green-50 border border-green-200 rounded-lg p-4 text-center">
              <i class="fas fa-check-circle text-green-500 text-3xl mb-2"></i>
              <p class="text-green-700 font-semibold">تم تسجيل الدخول بنجاح!</p>
            </div>

            <!-- Error Message (hidden by default) -->
            <div id="error-message" class="hidden bg-red-50 border border-red-200 rounded-lg p-4 text-center">
              <i class="fas fa-exclamation-circle text-red-500 text-3xl mb-2"></i>
              <p class="text-red-700 font-semibold" id="error-text"></p>
            </div>
          </form>

          <!-- Sign Up Link -->
          <div class="mt-6 text-center">
            <p class="text-muted font-tajawal">
              ليس لديك حساب؟
              <a href="signup.html" class="text-primary hover:underline font-semibold">
                إنشاء حساب جديد
              </a>
            </p>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer
      class="bg-contrast text-white py-8 sm:py-10 md:py-12 animate-on-scroll"
    >
      <div
        class="container mx-auto px-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 sm:gap-8 text-center md:text-right"
      >
        <!-- Logo and Copyright -->
        <div>
          <a
            href="index.html"
            class="text-2xl font-cairo font-bold text-primary block mb-4"
            id="footer-logo"
          ></a>
          <p class="text-muted text-sm" id="footer-copyright"></p>
        </div>

        <!-- Quick Links -->
        <div>
          <h4 class="text-xl font-cairo font-bold text-white mb-4">
            روابط سريعة
          </h4>
          <ul class="space-y-2" id="footer-quick-links">
            <!-- Quick links will be injected by JS -->
          </ul>
        </div>

        <!-- Social Media -->
        <div>
          <h4 class="text-xl font-cairo font-bold text-white mb-4">تابعنا</h4>
          <div
            class="flex justify-center md:justify-end space-x-4 space-x-reverse"
            id="footer-socials"
          >
            <!-- Social icons will be injected by JS -->
          </div>
        </div>
      </div>
    </footer>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="./content.js"></script>
    
    <!-- Footer Content Script -->
    <script>
      // Populate Footer Section from content.js
      if (typeof content !== 'undefined' && content.footer) {
        $('#footer-logo').text(content.footer.logo);
        $('#footer-copyright').text(content.footer.copyright);

        const quickLinksContainer = $('#footer-quick-links');
        content.footer.quickLinks.forEach(link => {
          quickLinksContainer.append(`<li><a href="${link.href}" class="text-muted hover:text-primary transition-colors font-tajawal">${link.label}</a></li>`);
        });

        const socialIconsContainer = $('#footer-socials');
        content.footer.socials.forEach(social => {
          socialIconsContainer.append(`<a href="${social.href}" class="text-muted hover:text-primary transition-colors text-xl"><i class="${social.icon}"></i></a>`);
        });
      }
    </script>
    
    <!-- Sign In Form Script -->
    <script>
      $(document).ready(function() {
        const form = $('#signin-form');
        const signinButton = $('#signin-button');
        const loadingSpinner = $('#loading-spinner');
        const successMessage = $('#success-message');
        const errorMessage = $('#error-message');
        const errorText = $('#error-text');
        const togglePassword = $('#toggle-password');
        const passwordInput = $('#password');
        const passwordIcon = $('#password-icon');

        // API endpoint - Replace with your actual API endpoint
        const API_ENDPOINT = 'https://your-api-endpoint.com/api/signin';

        // Toggle password visibility
        togglePassword.on('click', function() {
          const type = passwordInput.attr('type') === 'password' ? 'text' : 'password';
          passwordInput.attr('type', type);
          
          if (type === 'password') {
            passwordIcon.removeClass('fa-eye-slash').addClass('fa-eye');
          } else {
            passwordIcon.removeClass('fa-eye').addClass('fa-eye-slash');
          }
        });

        // Form validation
        function validateForm() {
          let isValid = true;
          const identifier = $('#identifier').val().trim();
          const password = $('#password').val();

          // Reset error messages
          $('.error-message').addClass('hidden').text('');

          // Validate Identifier
          if (!identifier) {
            $('#identifier').next('.error-message').text('الرجاء إدخال رقم الجوال أو البريد الإلكتروني').removeClass('hidden');
            isValid = false;
          }

          // Validate Password
          if (!password) {
            $('#password').next('.error-message').text('الرجاء إدخال كلمة المرور').removeClass('hidden');
            isValid = false;
          } else if (password.length < 6) {
            $('#password').next('.error-message').text('كلمة المرور يجب أن تكون 6 أحرف على الأقل').removeClass('hidden');
            isValid = false;
          }

          return isValid;
        }

        // Form submission
        form.on('submit', function(e) {
          e.preventDefault();

          // Hide previous messages
          successMessage.addClass('hidden');
          errorMessage.addClass('hidden');

          // Validate form
          if (!validateForm()) {
            return;
          }

          // Prepare form data
          const formData = {
            identifier: $('#identifier').val().trim(),
            password: $('#password').val(),
            rememberMe: $('#rememberMe').is(':checked')
          };

          // Show loading state
          signinButton.addClass('hidden');
          loadingSpinner.removeClass('hidden');
          form.find('input').prop('disabled', true);

          // Send API request
          $.ajax({
            url: API_ENDPOINT,
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(formData),
            success: function(response) {
              // Hide loading spinner
              loadingSpinner.addClass('hidden');
              
              // Show success message
              successMessage.removeClass('hidden');
              
              // Store token if provided
              if (response.token) {
                localStorage.setItem('authToken', response.token);
              }
              
              // Store user data if provided
              if (response.user) {
                localStorage.setItem('userData', JSON.stringify(response.user));
              }

              // Store remember me preference
              if (formData.rememberMe && response.token) {
                localStorage.setItem('rememberMe', 'true');
              } else {
                localStorage.removeItem('rememberMe');
              }
              
              // Scroll to success message
              $('html, body').animate({
                scrollTop: successMessage.offset().top - 100
              }, 500);

              // Redirect after 1.5 seconds
              setTimeout(function() {
                window.location.href = 'index.html'; // Redirect to home page or dashboard
              }, 1500);
            },
            error: function(xhr, status, error) {
              // Hide loading spinner
              loadingSpinner.addClass('hidden');
              
              // Show error message
              let errorMsg = 'حدث خطأ أثناء تسجيل الدخول. الرجاء المحاولة مرة أخرى.';
              
              if (xhr.responseJSON && xhr.responseJSON.message) {
                errorMsg = xhr.responseJSON.message;
              } else if (xhr.status === 0) {
                errorMsg = 'لا يمكن الاتصال بالخادم. الرجاء التحقق من اتصالك بالإنترنت.';
              } else if (xhr.status === 401) {
                errorMsg = 'رقم الجوال/البريد الإلكتروني أو كلمة المرور غير صحيحة.';
              } else if (xhr.status === 404) {
                errorMsg = 'الحساب غير موجود. الرجاء التحقق من البيانات المدخلة.';
              } else if (xhr.status === 403) {
                errorMsg = 'تم تعطيل حسابك. الرجاء التواصل مع الدعم الفني.';
              }

              errorText.text(errorMsg);
              errorMessage.removeClass('hidden');
              
              // Scroll to error message
              $('html, body').animate({
                scrollTop: errorMessage.offset().top - 100
              }, 500);
            },
            complete: function() {
              // Re-enable form
              signinButton.removeClass('hidden');
              form.find('input').prop('disabled', false);
            }
          });
        });

        // Clear error messages on input
        form.find('input').on('input', function() {
          $(this).next('.error-message').addClass('hidden');
        });

        // Check if user is already logged in
        if (localStorage.getItem('authToken')) {
          // Optionally redirect to dashboard or show a message
          // window.location.href = 'index.html';
        }

        // Handle forgot password link
        $('#forgot-password-link').on('click', function(e) {
          e.preventDefault();
          // You can implement forgot password functionality here
          alert('سيتم إرسال رابط إعادة تعيين كلمة المرور إلى بريدك الإلكتروني أو رقم جوالك.');
        });
      });
    </script>
  </body>
</html>

